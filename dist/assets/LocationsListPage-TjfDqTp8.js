import{u as e,r as s,h as a,j as t,m as l,o as r,p as i,v as n,M as d,B as c,al as o,t as x}from"./react-vendor-B7zQ2Eq0.js";import{u as m,d as h,S as u,B as b,s as g}from"./admin-DR-prBnq.js";import"./vendor-CnJW_4UD.js";import"./supabase-vendor-Cq9hqQQH.js";import"./date-vendor-CSGrVI8S.js";const j=()=>{const j=e(),{user:p,loading:N}=m(),{isAdmin:f,loading:v}=h(),[y,w]=s.useState(!1),[C,L]=s.useState(""),_=!N&&!!(null==p?void 0:p.id),{data:S,isLoading:k,error:q}=a({queryKey:["locations-list"],queryFn:async()=>{const{data:e,error:s}=await g.from("locations").select("id, name, building, floor, code, is_active").eq("is_active",!0).order("building",{ascending:!0}).order("floor",{ascending:!0}).order("name",{ascending:!0});if(s)throw s;return e||[]},enabled:_,staleTime:12e4}),A=(null==S?void 0:S.filter(e=>e.name.toLowerCase().includes(C.toLowerCase())||e.building.toLowerCase().includes(C.toLowerCase())||e.floor.toLowerCase().includes(C.toLowerCase())))||[],T=A.reduce((e,s)=>(e[s.building]||(e[s.building]=[]),e[s.building].push(s),e),{});return N?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600 text-sm",children:"Loading authentication..."})]})}):p?t.jsxs("div",{className:"min-h-screen bg-white pb-24",children:[t.jsx(u,{isOpen:y,onClose:()=>w(!1)}),t.jsxs("div",{className:"bg-white p-6 border-b border-gray-100",children:[t.jsx("div",{className:"flex items-center justify-between mb-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>w(!0),className:"w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-md hover:shadow-lg transition-shadow border border-gray-100",children:t.jsx(l,{className:"w-5 h-5 text-gray-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Locations"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Select location to inspect"})]})]})}),t.jsxs("div",{className:"relative mb-3",children:[t.jsx(r,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Search locations...",value:C,onChange:e=>L(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),f&&t.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[t.jsxs("button",{onClick:()=>j("/locations/add"),className:"bg-blue-600 text-white py-3 rounded-xl font-medium shadow-lg hover:bg-blue-700 active:scale-[0.98] transition-all flex items-center justify-center gap-2",children:[t.jsx(i,{className:"w-5 h-5"}),t.jsx("span",{children:"Add New"})]}),t.jsxs("button",{onClick:()=>j("/admin/locations"),className:"bg-gray-800 text-white py-3 rounded-xl font-medium shadow-lg hover:bg-gray-900 active:scale-[0.98] transition-all flex items-center justify-center gap-2",children:[t.jsx(n,{className:"w-5 h-5"}),t.jsx("span",{children:"Manage"})]})]})]}),t.jsx("div",{className:"p-5",children:k?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Loading locations..."})]}):0===A.length?t.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl shadow-[0_8px_30px_rgb(0,0,0,0.08)] border border-gray-50 p-8",children:[t.jsx(d,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:C?"No Results":"No Locations Available"}),t.jsx("p",{className:"text-gray-500 text-sm",children:C?"Try a different search term":"No locations found. Contact admin."})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Locations"}),t.jsx("p",{className:"text-2xl font-bold text-blue-900",children:A.length})]}),t.jsx(c,{className:"w-10 h-10 text-blue-600"})]})}),Object.entries(T).map(([e,s])=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(c,{className:"w-5 h-5 text-gray-500"}),t.jsx("h2",{className:"font-bold text-gray-900",children:e}),t.jsxs("span",{className:"text-sm text-gray-500",children:["(",s.length,")"]})]}),t.jsx("div",{className:"space-y-2",children:s.map(e=>t.jsx("button",{onClick:()=>{return s=e.id,void j(`/inspect/${s}`);var s},className:"w-full bg-white rounded-xl p-4 shadow-[0_4px_20px_rgb(0,0,0,0.06)] border border-gray-50 hover:shadow-[0_8px_30px_rgb(0,0,0,0.12)] active:translate-y-1 transition-all",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center",children:t.jsx(d,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-semibold text-gray-900",children:e.name}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx(o,{className:"w-3 h-3 text-gray-400"}),t.jsx("span",{className:"text-sm text-gray-500",children:e.floor}),e.code&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-gray-300",children:"â€¢"}),t.jsx("span",{className:"text-xs text-gray-400 font-mono",children:e.code})]})]})]})]}),t.jsx(x,{className:"w-5 h-5 text-gray-400"})]})},e.id))})]},e))]})}),t.jsx(b,{})]}):(j("/login",{replace:!0}),null)};export{j as LocationsListPage};
