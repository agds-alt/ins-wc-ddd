import{f as e,r as s,a,j as t,O as r,S as l,c as i,M as n,s as d,aj as c,g as o}from"./react-vendor-B_wON18L.js";import{u as x,s as m}from"./admin-DxXcpQLf.js";import{S as h,B as u}from"./reports-CYvdUc55.js";import"./vendor-C4HD8sBH.js";import"./supabase-vendor-Ck00pQO2.js";import"./date-vendor-DWqTPjCA.js";import"./inspection-Bd6L4SDO.js";const b=()=>{const b=e(),{user:j,authLoading:g}=x(),[p,f]=s.useState(!1),[N,v]=s.useState(""),y=!g&&!!(null==j?void 0:j.id),{data:w,isLoading:L}=a({queryKey:["locations-list"],queryFn:async()=>{const{data:e,error:s}=await m.from("locations").select("id, name, building, floor, code, is_active").eq("is_active",!0).order("building",{ascending:!0}).order("floor",{ascending:!0}).order("name",{ascending:!0});if(s)throw s;return e||[]},enabled:y,staleTime:12e4}),C=(null==w?void 0:w.filter(e=>e.name.toLowerCase().includes(N.toLowerCase())||e.building.toLowerCase().includes(N.toLowerCase())||e.floor.toLowerCase().includes(N.toLowerCase())))||[],_=C.reduce((e,s)=>(e[s.building]||(e[s.building]=[]),e[s.building].push(s),e),{});return g?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600 text-sm",children:"Loading..."})]})}):j?t.jsxs("div",{className:"min-h-screen bg-white pb-24",children:[t.jsx(h,{isOpen:p,onClose:()=>f(!1)}),t.jsxs("div",{className:"bg-white p-6 border-b border-gray-100",children:[t.jsx("div",{className:"flex items-center justify-between mb-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>f(!0),className:"w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-md hover:shadow-lg transition-shadow border border-gray-100",children:t.jsx(r,{className:"w-5 h-5 text-gray-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Locations"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Select location to inspect"})]})]})}),t.jsxs("div",{className:"relative mb-3",children:[t.jsx(l,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Search locations...",value:N,onChange:e=>v(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t.jsxs("button",{onClick:()=>b("/locations/add"),className:"w-full bg-blue-600 text-white py-3 rounded-xl font-medium shadow-lg hover:bg-blue-700 active:scale-[0.98] transition-all flex items-center justify-center gap-2",children:[t.jsx(i,{className:"w-5 h-5"}),t.jsx("span",{children:"Add New Location"})]})]}),t.jsx("div",{className:"p-5",children:L?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Loading locations..."})]}):0===C.length?t.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl shadow-[0_8px_30px_rgb(0,0,0,0.08)] border border-gray-50 p-8",children:[t.jsx(n,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:N?"No Results":"No Locations Available"}),t.jsx("p",{className:"text-gray-500 text-sm",children:N?"Try a different search term":"No locations found. Contact admin."})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Locations"}),t.jsx("p",{className:"text-2xl font-bold text-blue-900",children:C.length})]}),t.jsx(d,{className:"w-10 h-10 text-blue-600"})]})}),Object.entries(_).map(([e,s])=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(d,{className:"w-5 h-5 text-gray-500"}),t.jsx("h2",{className:"font-bold text-gray-900",children:e}),t.jsxs("span",{className:"text-sm text-gray-500",children:["(",s.length,")"]})]}),t.jsx("div",{className:"space-y-2",children:s.map(e=>t.jsx("button",{onClick:()=>{return s=e.id,void b(`/inspect/${s}`);var s},className:"w-full bg-white rounded-xl p-4 shadow-[0_4px_20px_rgb(0,0,0,0.06)] border border-gray-50 hover:shadow-[0_8px_30px_rgb(0,0,0,0.12)] active:translate-y-1 transition-all",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center",children:t.jsx(n,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-semibold text-gray-900",children:e.name}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx(c,{className:"w-3 h-3 text-gray-400"}),t.jsx("span",{className:"text-sm text-gray-500",children:e.floor}),e.code&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-gray-300",children:"â€¢"}),t.jsx("span",{className:"text-xs text-gray-400 font-mono",children:e.code})]})]})]})]}),t.jsx(o,{className:"w-5 h-5 text-gray-400"})]})},e.id))})]},e))]})}),t.jsx(u,{})]}):(b("/login",{replace:!0}),null)};export{b as LocationsListPage};
